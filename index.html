<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta name="description"
        content="Universal Checkpointing: Efficient and Flexible Checkpointing for Large Scale Distributed Training.">
  <meta name="keywords" content="Universal Checkpointing, DNN, Training">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Universal Checkpointing: Efficient and Flexible Checkpointing for Large Scale Distributed Training</title>

  <link href="https://fonts.googleapis.com/css?family=Google+Sans|Noto+Sans|Castoro"
        rel="stylesheet">

  <link rel="stylesheet" href="./static/css/bulma.min.css">
  <link rel="stylesheet" href="./static/css/bulma-carousel.min.css">
  <link rel="stylesheet" href="./static/css/bulma-slider.min.css">
  <link rel="stylesheet" href="./static/css/fontawesome.all.min.css">
  <link rel="stylesheet"
        href="https://cdn.jsdelivr.net/gh/jpswalsh/academicons@1/css/academicons.min.css">
  <link rel="stylesheet" href="./static/css/index.css">
  <link rel="icon" href="./static/images/favicon.svg">

  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
  <script defer src="./static/js/fontawesome.all.min.js"></script>
  <script src="./static/js/bulma-carousel.min.js"></script>
  <script src="./static/js/bulma-slider.min.js"></script>
  <script src="./static/js/index.js"></script>
</head>
<body>

  <nav class="navbar" role="navigation" aria-label="main navigation">
    <div class="navbar-brand">
      <a role="button" class="navbar-burger" aria-label="menu" aria-expanded="false">
        <span aria-hidden="true"></span>
        <span aria-hidden="true"></span>
        <span aria-hidden="true"></span>
      </a>
    </div>
    <div class="navbar-menu">
      <div class="navbar-start" style="flex-grow: 1; justify-content: center;">
        <a class="navbar-item" href="https://https://minjiazhang.github.io">
        <span class="icon">
            <i class="fas fa-home"></i>
        </span>
        </a>
  
        <div class="navbar-item has-dropdown is-hoverable">
          <a class="navbar-link">
            More Research
          </a>
          <div class="navbar-dropdown">
            <a class="navbar-item" href="https://https://minjiazhang.github.io/">
              Publications
            </a>
          </div>
        </div>
      </div>
  
    </div>
  </nav>

<section class="hero">
  <div class="hero-body">
    <div class="container is-max-desktop">
      <div class="columns is-centered">
        <div class="column has-text-centered">
          <h1 class="title is-1 publication-title">Universal Checkpointing: Efficient and Flexible Checkpointing for Large Scale Distributed Training</h1>
          <div class="is-size-5 publication-authors">
            <span class="author-block">
              <a href="https://xinyulian.tech/">Xinyu Lian</a><sup>1</sup>,</span>
            <span class="author-block">
              <a href="https://github.com/samadejacobs">Sam Ade Jacobs</a><sup>2</sup>,</span>
            <span class="author-block">
              <a href="https://www.linkedin.com/in/lev-kurilenko-99a217117/">Lev Kurilenko</a><sup>2</sup>,
            </span>
            <span class="author-block">
              <a href="https://tohtana.github.io/">Masahiro Tanaka</a><sup>2</sup>,
            </span>
            <span class="author-block">
              <a href="https://stasosphere.com/machine-learning/">Stas Bekman</a><sup>3</sup>,
            </span>
            <span class="author-block">
              <a href="https://www.microsoft.com/en-us/research/people/olruwase/">Olatunji Ruwase</a><sup>2</sup>,
            </span>
            <span class="author-block">
              <a href="https://minjiazhang.github.io/">Minjia Zhang</a><sup>1</sup>
            </span>
          </div>
 
          <div class="is-size-5 publication-authors">
            <span class="author-block"><sup>1</sup>University of Illinois Urbana-Champaign,</span>
            <span class="author-block"><sup>2</sup>Microsoft</span>
            <span class="author-block"><sup>3</sup>Stasosphere</span>
          </div>

          <!-- <div class="is-size-5">
            <sup>1</sup> <a href="https://illinois.edu/"><img style="width:15%; padding-right: 15px;"
                    src="static/logo/uiuc.png"> </a>
            <sup>2</sup> <a href="https://www.microsoft.com/en-us/research/"><img style="width:20%; padding-right: 15px;"
                    src="static/logo/microsoft.jpg"> </a>
            <sup>3</sup> <a href="https://stasosphere.com/machine-learning/"><img style="width:12%; padding-right: 15px;"
                    src="static/logo/s-logo.png"> </a>
        </div> -->

        <div class="column has-text-centered">
            <div class="publication-links">
              <!-- PDF Link. -->
              <span class="link-block">
                <a href="https://arxiv.org/abs/2406.18820"
                   class="external-link button is-normal is-rounded is-dark">
                  <span class="icon">
                      <i class="fas fa-file-pdf"></i>
                  </span>
                  <span>Paper</span>
                </a>
              </span>
              <span class="link-block">
                <a href="https://arxiv.org/abs/2406.18820"
                   class="external-link button is-normal is-rounded is-dark">
                  <span class="icon">
                      <i class="ai ai-arxiv"></i>
                  </span>
                  <span>arXiv</span>
                </a>
              </span>
              <!-- Video Link. -->
              <!-- <span class="link-block">
                <a href="https://www.youtube.com/watch?v=MrKrnHhk8IA"
                   class="external-link button is-normal is-rounded is-dark">
                  <span class="icon">
                      <i class="fab fa-youtube"></i>
                  </span>
                  <span>Video</span>
                </a>
              </span> -->
              <!-- Code Link. -->
              <span class="link-block">
                <a href="https://github.com/microsoft/DeepSpeed"
                   class="external-link button is-normal is-rounded is-dark">
                  <span class="icon">
                      <i class="fab fa-github"></i>
                  </span>
                  <span>Code</span>
                  </a>
              </span>
              <span class="link-block">
                <a href="https://www.deepspeed.ai/tutorials/universal-checkpointing/"
                   class="external-link button is-normal is-rounded is-dark">
                  <span class="icon">
                      <i class="fas fa-toggle-on"></i>
                  </span>
                  <span>Tutorial</span>
                  </a>
              </span>
              <span class="link-block">
                <a href="https://github.com/microsoft/DeepSpeed/blob/master/blogs/deepspeed-ucp/README.md"
                   class="external-link button is-normal is-rounded is-dark">
                  <span class="icon">
                      <i class="fas fa-blog"></i>
                  </span>
                  <span>Blog</span>
                  </a>
              </span>
              <!-- Dataset Link. -->
              <!-- <span class="link-block">
                <a href="https://github.com/google/nerfies/releases/tag/0.1"
                   class="external-link button is-normal is-rounded is-dark">
                  <span class="icon">
                      <i class="far fa-images"></i>
                  </span>
                  <span>Data</span>
                </a>
              </span> -->
            </div>

          </div>
        </div>
      </div>
    </div>
  </div>
</section>

<section class="hero teaser">
  <div class="container is-max-desktop">
    <div class="hero-body">
      <img src="./static/images/ucp.jpg"
      class="interpolation-image"
      alt="UCP main results image."/>
      <h2 class="subtitle has-text-centered">
        UCP boosts large-scale training efficiency: 
        <ul>
          <li>ðŸš€ Flexible change of parallelism (PP, SP, TP, ZeRO-DP) or GPU count mid-stream </li>
          <li>ðŸš€ Improve resilience by scaling down to healthy nodes</li>
          <li>ðŸš€ Increase throughput by scaling up to elastic nodes</li>
        </ul>
      </h2>
    </div>
  </div>
</section>

<section class="section">
  <div class="container is-max-desktop">
    <!-- Abstract. -->
    <div class="columns is-centered has-text-centered">
      <div class="column is-four-fifths">
        <h2 class="title is-3">Abstract</h2>
        <div class="content has-text-justified">
          <p>
            Existing checkpointing approaches seem ill-suited for distributed training even though hardware limitations make model parallelism, i.e., sharding model state across multiple accelerators, a requirement for model scaling. Consolidating distributed model state into a single checkpoint unacceptably slows down training, and is impractical at extreme scales. Distributed checkpoints, in contrast, are tightly coupled to the model parallelism and hardware configurations of the training run, and thus unusable on different configurations. To address this problem, we propose Universal Checkpointing, a technique that enables efficient checkpoint creation while providing the flexibility of resuming on arbitrary parallelism strategy and hardware configurations. Universal Checkpointing unlocks unprecedented capabilities for large-scale training such as improved resilience to hardware failures through continued training on remaining healthy hardware, and reduced training time through opportunistic exploitation of elastic capacity.
          </p>
          <p>
            The key insight of Universal Checkpointing is the selection of the optimal representation in each phase of the checkpointing life cycle: distributed representation for saving, and consolidated representation for loading. This is achieved using two key mechanisms. First, the universal checkpoint format, which consists of a consolidated representation of each model parameter and metadata for mapping parameter fragments into training ranks of arbitrary model-parallelism configuration. Second, the universal checkpoint language, a simple but powerful specification language for converting distributed checkpoints into the universal checkpoint format. Our evaluation demonstrates the effectiveness and generality of Universal Checkpointing on state-of-the-art model architectures and a wide range of parallelism techniques.
          </p>
        </div>
      </div>
    </div>
    <!--/ Abstract. -->
  </div>
</section>


<section class="section">
  <div class="container is-max-desktop">

    <div class="columns is-centered">

      <div class="column">
        <div class="content">
          <h2 class="title is-3">Method</h2>
          <img src="./static/images/ucp-method.png"
          class="interpolation-image"
          alt="UCP method."/>
        </div>
        <p>
          UCP supports flexible checkpoint transformation along any training parallelism techniques (e.g., ZeRO-DP, TP, PP, SP). It enables elastic resource management, allowing easy scaling up and down of training and fine-tuning with varying hardware resources. UCP includes a convenient language-integrated programming interface that allows users to describe various parallelism patterns and provides transformation operations to easily transform distributed checkpoints into UCP. UCP also provides cross-framework support, enabling resuming training of checkpoints from other popular training frameworks, such as HuggingFace transformer accelerate and PyTorch lightning with DeepSpeed as a backend.
        </p>
      </div>
    </div>
  </div>
</section>

<section class="section" id="BibTeX">
  <div class="container is-max-desktop content">
    <h2 class="title">BibTeX</h2>
    <pre><code>@article{ucp2024,
  author    = {Lian, Xinyu and Jacobs, Sam Ade and Kurilenko, Lev and Tanaka, Masahiro and Bekman, Stas and Ruwase, Olatunji and Zhang, Minjia},
  title     = {Universal Checkpointing: Efficient and Flexible Checkpointing for Large Scale Distributed Training},
  journal   = {arXiv preprint arXiv:2406.18820},
  year      = {2024},
}</code></pre>
  </div>
</section>


<footer class="footer">
  <div class="container">
    <div class="columns is-centered">
      <div class="column is-8">
        <div class="content">
          <p>
            We thank the authors of <a href="https://nerfies.github.io/">Nerfies</a> that kindly open sourced the template of this website. 
          </p>
        </div>
      </div>
    </div>
  </div>
</footer>

</body>
</html>
